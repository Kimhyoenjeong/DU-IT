package user;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import javax.sql.DataSource;



public class UserDAO {// DAO의 사용이유 https://minaminaworld.tistory.com/61

	private Connection conn; //자바와 데이터베이스를 연결
	private PreparedStatement pstmt; //sql injection등 공격을 막기 위해 사용자에게 변수에 값만 받아서 구문을 실행
	private ResultSet rs; // SQL문 실행 후에 결과값 받아오기
	
	//DB연결
	public UserDAO() {
		try {
			//try catch 문을 이용해 예외처리
			String driverName = "oracle.jdbc.driver.OracleDriver";//oracle driver을 찾기 위해 작성(oracle 접속을 위한 매개체)
			String dbURL = "jdbc:oracle:thin:@localhost:1521:xe";
			String dbID = "scott";//db 접속시 만든 id
			String dbPassword = "1234"; //그 password
			Class.forName(driverName); //
			conn = DriverManager.getConnection(dbURL, dbID, dbPassword); //db에 접속하기 위한 코드
		}catch (Exception e) {
			e.printStackTrace();//에러 메세지의 발생 근원지를 찾아 단계별로 에러 출력
		
		}
	}
	
	public int login (int  STUDENT_ID, String PASSWORD) {
		String sql = "select userPassword from user where userID = ? ";
		try {
			pstmt = conn.prepareStatement(sql);
			pstmt = setInt(1, STUDENT_ID);
			rs = pstmt.executeQuery();
			if(rs.next()) {
				if(rs.getString(1).equals(PASSWORD)) {
					return 1;
				}else
					return 0;
			}
			return -1;
		}catch (Exception e) {
			e.printStackTrace();
		}
		return -2;	
	}
	private PreparedStatement setInt(int i, int sTUDENT_ID) {
		// TODO Auto-generated method stub
		return null;
	}
}



